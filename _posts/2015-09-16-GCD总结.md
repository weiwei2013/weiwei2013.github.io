---
layout: post
title: iOS多线程中GCD的总结
description: "iOS多线程中GCD的总结"
modified: 2015-09-16
tags: [iOS, GCD,多线程]
---
<b> 一、首先介绍一下什么是GCD?
 (Grand Central Dispatch)是一套底层纯的API，提供了一种新的方法来进行并发程序编写。从基本功能上讲，GCD有点像NSOperationQueue，他们都允许程序将任务切分为多个单一任务然后提交至工作队列来并发地或者串行地执行。GCD比之NSOpertionQueue更底层更高效，并且它不是Cocoa框架的一部分。
 除了代码的平行执行能力，GCD还提供高度集成的事件控制系统。可以设置句柄来响应文件描述符、mach ports（Mach port 用于 OS X上的进程间通讯）、进程、计时器、信号、用户生成事件。这些句柄通过GCD来并发执行。
 GCD的API很大程度上基于block，当然，GCD也可以脱离block来使用，比如使用传统c机制提供函数指针和上下文指针。实践证明，当配合block使用时，GCD非常简单易用且能发挥其最大能力。
 GCD 是一个替代诸如 NSThread, NSOperationQueue, NSInvocationOperation 等技术的很高效和强大的技术。
 你可以在Mac上敲命令“man dispatch”来获取GCD的文档。</b>
 <b>GCD的优势：能够自动的管理线程的生命周期</b>
 <br>
 <b>同步和异步，串行队列和并行队列</b>
 <br>
 <p> 同步：同步不会开启新线程    异步：异步会开启新线程</p>
 <p>到底开不开还要看使用的是什么队列</p>
 <br>
 <p>并行：并行队列中的任务可以同时执行</p>
 <p>串行：一个任务接着一个任务的执行</p>
 <br>
 <b>
 在说说队列的三种：  Dispatch Queue 是一个任务执行队列 FIFO 先进先出
 </b>
<p> (1)串行队列：(Serial dispatch queue)
 串行队列中，一次只能处理一个任务，dispatch_queue_create
 dispatch_queue_t aaa = [dispatch_queue_create(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
</p>
<br>
<p>
	(2)并发队列：(Concurrent dispatch queue)
 并行队列中的任务可以同时被执行(可以设置最大线程并发数)
</p>
<br>
{% highlight cpp %}
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);
{% endhighlight %}
<p>
	 (3)主队列：(Main dispatch queue)
 主队列是一个特殊的串行队列，它是系统预定义的运行在主线程的一个Dispatch Queue。可以通过dispatch_get_main_queue来获取唯一的主队列。主队列中的任务一定是在主线程中执行的。
</p>
<br>
 栗子:
{% highlight cpp %}
dispatch_sync(dispatch_get_main_queue(), ^{
 NSLog(@"我会打印吗?");
 });
PS:在主线程中执行串行函数调用主队列中的任务就会造成相互等待状态，造成死循环。
{% endhighlight %}








